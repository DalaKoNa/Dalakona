<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PasaBuy ‚Äì Handumanan Delivery</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fff;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
    }
    .container {
      max-width: 600px;
      width: 100%;
      border: 1px solid #ddd;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .field {
      margin-bottom: 16px;
    }
    .field label {
      font-weight: bold;
      display: block;
      margin-bottom: 6px;
    }
    .field input, .field textarea, .field select {
      width: 100%;
      padding: 8px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .items-container {
      margin-bottom: 20px;
    }
    .item-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }
    .item-row input {
      flex: 1;
    }
    .proof-preview {
      margin-top: 10px;
      max-width: 100%;
      max-height: 150px;
    }
    button {
      background-color: #333;
      color: #fff;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>PasaBuy Order ‚Äì Handumanan Only</h2>
    <form id="orderForm">
      <div class="field">
        <label for="customerName">Full Name</label>
        <input type="text" id="customerName" required />
      </div>
      <div class="field">
        <label for="phoneNumber">Phone Number</label>
        <input type="tel" id="phoneNumber" required />
      </div>
      <div class="field">
        <label for="address">Exact Address (Handumanan only)</label>
        <input type="text" id="address" required />
      </div>
      <div class="field">
        <label>Items to Buy</label>
        <div class="items-container" id="itemsContainer"></div>
        <button type="button" onclick="addItem()">+ Add Item</button>
      </div>

      <div class="field">
        <label for="deliveryOption">Delivery Option</label>
        <select id="deliveryOption" required onchange="toggleDeliveryTime()">
          <option value="today">Deliver Today</option>
          <option value="later">Deliver Later</option>
        </select>
      </div>
      <div class="field">
        <label for="deliveryDate">Delivery Date</label>
        <input type="date" id="deliveryDate" required disabled />
      </div>
      <div class="field">
        <label for="deliveryTime">Delivery Time</label>
        <input type="time" id="deliveryTime" required disabled />
      </div>

      <div class="field">
        <label for="budget">Budget Estimate (‚Ç±)</label>
        <input type="number" id="budget" required />
      </div>

      <div class="field">
        <label for="depositProof">Upload Proof of 50% Downpayment</label>
        <input type="file" id="depositProof" accept="image/*" required />
        <img id="proofPreview" class="proof-preview" />
      </div>

      <div class="field">
        <strong>Total (est.): ‚Ç±<span id="totalEstimate">0</span></strong><br/>
        <strong>Downpayment (50%): ‚Ç±<span id="downPayment">0</span></strong><br/>
        <small>+ Service Fee ‚Ç±29.99 & Delivery Fee ‚Ç±10.01 already included</small>
      </div>

      <div class="field">
        <strong>Bank Details:</strong>
        <p>BPI<br/>Account Name: Dala Ko Na Service<br/>Account #: 1234-5678-90</p>
      </div>

      <button type="submit">Submit Order via WhatsApp</button>
    </form>
  </div>

  <script>
    const itemsContainer = document.getElementById('itemsContainer');
    const deliveryOption = document.getElementById('deliveryOption');
    const deliveryDate = document.getElementById('deliveryDate');
    const deliveryTime = document.getElementById('deliveryTime');

    function toggleDeliveryTime() {
      if (deliveryOption.value === 'later') {
        deliveryDate.disabled = false;
        deliveryTime.disabled = false;
        const today = new Date();
        deliveryDate.min = today.toISOString().split('T')[0];
        deliveryTime.min = '09:00';
        deliveryTime.max = '18:00';
      } else {
        deliveryDate.disabled = true;
        deliveryTime.disabled = true;
      }
    }

    function addItem() {
      const row = document.createElement('div');
      row.className = 'item-row';
      row.innerHTML = `
        <input type="text" placeholder="Item name" required />
        <input type="number" placeholder="Qty" min="1" value="1" required />
        <input type="text" placeholder="Notes (optional)" />
      `;
      itemsContainer.appendChild(row);
    }

    document.getElementById('depositProof').addEventListener('change', (e) => {
      const file = e.target.files[0];
      const preview = document.getElementById('proofPreview');
      if (file) preview.src = URL.createObjectURL(file);
    });

    document.getElementById('budget').addEventListener('input', updateTotals);

    function updateTotals() {
      const budget = parseFloat(document.getElementById('budget').value || 0);
      const total = budget + 29.99 + 10.01;
      const down = total * 0.5;
      document.getElementById('totalEstimate').textContent = total.toFixed(2);
      document.getElementById('downPayment').textContent = down.toFixed(2);
    }

    document.getElementById('orderForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const name = document.getElementById('customerName').value;
      const phone = document.getElementById('phoneNumber').value;
      const address = document.getElementById('address').value;
      const budget = document.getElementById('budget').value;
      const proof = document.getElementById('depositProof').files[0];
      const delivery = deliveryOption.value;
      const date = delivery === 'later' ? deliveryDate.value : 'Today';
      const time = delivery === 'later' ? deliveryTime.value : 'ASAP';

      let itemsText = '';
      const rows = itemsContainer.querySelectorAll('.item-row');
      rows.forEach(row => {
        const [item, qty, notes] = row.querySelectorAll('input');
        itemsText += `‚Ä¢ ${item.value} x${qty.value}${notes.value ? ` (${notes.value})` : ''}\n`;
      });

      const message = `PasaBuy Order:\nüë§ ${name}\nüìû ${phone}\nüìç ${address}\n\nüõí Items:\n${itemsText}\nüìÖ Delivery: ${date} ${time}\nüíµ Budget: ‚Ç±${budget}\nüìë Downpayment: Proof Uploaded\nüè¶ Sent to Bank\nüí∞ Total est.: ‚Ç±${(parseFloat(budget) + 29.99 + 10.01).toFixed(2)}\nüöö Service ‚Ç±29.99 + Delivery ‚Ç±10.01`;

      const encoded = encodeURIComponent(message);
      const adminWhatsApp = `https://wa.me/63XXXXXXXXXX?text=${encoded}`;
      const riderWhatsApp = `https://wa.me/63YYYYYYYYYY?text=${encoded}`;
      window.open(adminWhatsApp, '_blank');
      window.open(riderWhatsApp, '_blank');
    });

    // Add 1 item on load
    addItem();
  </script>
</body>
</html>
