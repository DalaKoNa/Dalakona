<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DalaðŸš²Na â€“ PasaBuy Order</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .form-card {
      background: #fff;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      width: 100%;
    }
    h2 {
      text-align: center;
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .item-group {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .item-group input {
      flex: 1;
    }
    .remove-item-btn {
      background: red;
      color: white;
      border: none;
      padding: 0 0.5rem;
      border-radius: 5px;
      cursor: pointer;
    }
    .add-item-btn {
      margin-top: 1rem;
      background: #007bff;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
    }
    .submit-btn {
      background: green;
      color: white;
      border: none;
      padding: 0.75rem;
      margin-top: 1.5rem;
      width: 100%;
      font-size: 1rem;
      border-radius: 5px;
    }
    .summary {
      margin-top: 1rem;
      font-weight: bold;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="form-card">
    <h2>PasaBuy Order Form</h2>
    <form id="pasabuyForm" onsubmit="handleSubmit(event)">
      <label>Customer Name *</label>
      <input type="text" id="name" required />

      <label>Phone Number *</label>
      <input type="tel" id="phone" required />

      <label>Store *</label>
      <select id="store" required>
        <option value="">Select a store</option>
        <option>Handumanan Hypermarket</option>
        <option>Chooks to Go</option>
        <option>Uling Rooster</option>
        <option>Goldilocks</option>
        <option>The Generics Pharmacy</option>
        <option>Watsons</option>
        <option>Julie's Bakeshop</option>
        <option>Bong Bongs</option>
        <option>Don Macchiatos</option>
        <option>Joe Joe's Chicken</option>
        <option>JDE Hardware</option>
        <option>Sabon Depot</option>
        <option>Mr. DIY</option>
        <option>Others - Specify</option>
      </select>

      <label>Exact Address *</label>
      <input type="text" id="address" required />

      <label>Geo Location Name *</label>
      <input type="text" id="geoLocation" required />

      <label>Delivery Type *</label>
      <select id="deliveryType" required>
        <option value="Today">Today (within 1 hour)</option>
        <option value="Later">Later - specify date/time</option>
      </select>

      <label>Delivery Time *</label>
      <input type="datetime-local" id="deliveryTime" required />

      <label>Item List *</label>
      <div id="items-container"></div>
      <button type="button" class="add-item-btn" onclick="addItem()">+ Add Item</button>

      <label>Estimated Total Budget (â‚±) *</label>
      <select id="budget" required>
        <option value="">Select budget</option>
        <option>500</option>
        <option>1000</option>
        <option>1500</option>
        <option>2000</option>
        <option>2500</option>
        <option>3000</option>
      </select>

      <label>Upload Deposit Proof *</label>
      <input type="file" id="depositProof" accept="image/*" required />

      <div class="summary">
        <p>Total Budget: â‚±<span id="totalBudget">0</span></p>
        <p>Required Downpayment (50%): â‚±<span id="downPayment">0</span></p>
      </div>

      <button type="submit" class="submit-btn">Submit & Send via WhatsApp</button>
    </form>
  </div>

  <script>
    function addItem(name = '', qty = '') {
      const container = document.getElementById('items-container');
      const itemGroup = document.createElement('div');
      itemGroup.className = 'item-group';
      itemGroup.innerHTML = `
        <input type="text" name="itemName[]" placeholder="Item name" value="${name}" required />
        <input type="number" name="itemQty[]" placeholder="Qty" value="${qty}" min="1" required />
        <button type="button" class="remove-item-btn" onclick="this.parentElement.remove()">ðŸ—‘</button>
      `;
      container.appendChild(itemGroup);
    }

    document.getElementById('budget').addEventListener('change', () => {
      const budget = parseFloat(document.getElementById('budget').value || '0');
      document.getElementById('totalBudget').textContent = budget.toFixed(2);
      document.getElementById('downPayment').textContent = (budget * 0.5).toFixed(2);
    });

    function handleSubmit(event) {
      event.preventDefault();
      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;
      const store = document.getElementById('store').value;
      const address = document.getElementById('address').value;
      const geo = document.getElementById('geoLocation').value;
      const deliveryType = document.getElementById('deliveryType').value;
      const deliveryTime = document.getElementById('deliveryTime').value;
      const budget = document.getElementById('budget').value;
      const items = [...document.querySelectorAll('.item-group')].map(el => {
        const itemName = el.querySelector('input[name="itemName[]"]').value;
        const itemQty = el.querySelector('input[name="itemQty[]"]').value;
        return `${itemName} x${itemQty}`;
      }).join(', ');

      const msg = `ðŸ“¦ *New PasaBuy Order*\n\nðŸ‘¤ Name: ${name}\nðŸ“ž Phone: ${phone}\nðŸª Store: ${store}\nðŸ“ Address: ${address}\nðŸŒ Geo: ${geo}\nðŸ“… Delivery: ${deliveryType} (${deliveryTime})\nðŸ›’ Items: ${items}\nðŸ’° Budget: â‚±${budget}\nðŸ’³ Downpayment: â‚±${(budget * 0.5).toFixed(2)}`;

      const encoded = encodeURIComponent(msg);
      window.location.href = `https://wa.me/63XXXXXXXXXX?text=${encoded}`;

      setTimeout(() => {
        window.location.href = 'pasabuy-thank-you.html';
      }, 1500);
    }
  </script>
</body>
</html>
