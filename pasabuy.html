<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pasabuy Order Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      font-family: 'Inter', sans-serif;
      box-sizing: border-box;
    }
    body {
      background: #f5f5f5;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .form-container {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 600px;
    }
    h2 {
      text-align: center;
      margin-bottom: 1rem;
    }
    label {
      font-weight: 600;
      display: block;
      margin-top: 1rem;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.75rem;
      margin-top: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 0.5rem;
    }
    .item-group {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .item-group input {
      flex: 1;
    }
    .remove-item-btn {
      background: red;
      color: white;
      border: none;
      padding: 0.5rem;
      border-radius: 0.5rem;
      cursor: pointer;
    }
    .summary {
      background: #f9f9f9;
      padding: 1rem;
      border: 1px dashed #999;
      margin-top: 1rem;
      border-radius: 0.5rem;
      font-size: 0.9rem;
    }
    .btn {
      background: green;
      color: white;
      padding: 1rem;
      margin-top: 1.5rem;
      border: none;
      width: 100%;
      font-weight: bold;
      border-radius: 0.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2>üõí Pasabuy Order Form</h2>

    <label for="store">Select Store *</label>
    <select id="store" required>
      <option value="">-- Select Store --</option>
      <option>Handumanan Hypermarket</option>
      <option>Chooks To Go</option>
      <option>Uling Rooster</option>
      <option>Goldilocks</option>
      <option>The Generics Pharmacy</option>
      <option>Watsons</option>
      <option>Julie's Bakeshop</option>
      <option>Bong Bongs</option>
      <option>Don Macchiatos</option>
      <option>Joe Joe's Chicken</option>
      <option>JDE Hardware and Construction Supply</option>
      <option>Sabon Depot</option>
      <option>Mr. DIY</option>
      <option>Others - specify in item</option>
    </select>

    <label>Items to Buy *</label>
    <div id="items-container"></div>
    <button type="button" onclick="addItem()">‚ûï Add Item</button>

    <label for="budget">Your Max Budget *</label>
    <select id="budget" required>
      <option value="">-- Select Budget --</option>
      <option>‚Ç±100</option>
      <option>‚Ç±300</option>
      <option>‚Ç±500</option>
      <option>‚Ç±1000</option>
      <option>‚Ç±1500</option>
      <option>‚Ç±2000</option>
      <option>‚Ç±2500</option>
      <option>‚Ç±3000</option>
    </select>

    <label for="name">Your Full Name *</label>
    <input type="text" id="name" required />

    <label for="phone">Phone Number *</label>
    <input type="tel" id="phone" required />

    <label for="address">Exact Address *</label>
    <input type="text" id="address" required />

    <label for="location">üìç Geolocation (autofill)</label>
    <input type="text" id="location" placeholder="Tap to get current location" onclick="getGeo()" readonly />

    <label for="deliveryType">Delivery Type *</label>
    <select id="deliveryType" onchange="toggleDeliveryDate()" required>
      <option value="today">Today (within 1 hour)</option>
      <option value="later">Deliver Later</option>
    </select>

    <label for="deliveryDate">Delivery Date *</label>
    <input type="date" id="deliveryDate" readonly />

    <label for="deliveryTime">Preferred Time *</label>
    <input type="time" id="deliveryTime" readonly />

    <label for="deposit">Proof of Bank Deposit (Image Upload) *</label>
    <input type="file" id="deposit" accept="image/*" required />

    <div class="summary" id="orderSummary"></div>

    <button class="btn" onclick="submitOrder()">‚úÖ Submit Order via WhatsApp</button>
  </div>

  <script>
    function addItem(name = '', qty = '') {
      const container = document.getElementById('items-container');
      const itemGroup = document.createElement('div');
      itemGroup.className = 'item-group';
      itemGroup.innerHTML = `
        <input type="text" name="itemName[]" placeholder="Item name" value="${name}" required />
        <input type="number" name="itemQty[]" placeholder="Qty" value="${qty}" min="1" required />
        <button type="button" class="remove-item-btn" onclick="this.parentElement.remove(); updateSummary();">üóë</button>
      `;
      container.appendChild(itemGroup);
      updateSummary();
    }

    function toggleDeliveryDate() {
      const type = document.getElementById('deliveryType').value;
      const date = document.getElementById('deliveryDate');
      const time = document.getElementById('deliveryTime');
      if (type === 'today') {
        const now = new Date();
        date.value = now.toISOString().split('T')[0];
        time.value = now.getHours() + 1 + ':00';
        date.readOnly = true;
        time.readOnly = true;
      } else {
        date.readOnly = false;
        time.readOnly = false;
      }
    }

    function getGeo() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          const { latitude, longitude } = pos.coords;
          fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`)
            .then(res => res.json())
            .then(data => {
              document.getElementById('location').value = data.display_name;
            });
        });
      }
    }

    function updateSummary() {
      const names = document.querySelectorAll('[name="itemName[]"]');
      const qtys = document.querySelectorAll('[name="itemQty[]"]');
      let summary = '<strong>Order Summary:</strong><br />';
      let total = 0;
      names.forEach((input, i) => {
        const name = input.value;
        const qty = qtys[i].value;
        summary += `${name} x${qty}<br />`;
        total += 50 * parseInt(qty); // sample estimate ‚Ç±50 per item
      });
      const fee = 29.99;
      const down = Math.ceil((total + fee) * 0.5);
      summary += `Subtotal: ‚Ç±${total.toFixed(2)}<br />Service Fee: ‚Ç±${fee}<br />`;
      summary += `<strong>50% Downpayment: ‚Ç±${down}</strong>`;
      document.getElementById('orderSummary').innerHTML = summary;
    }

    function submitOrder() {
      updateSummary();
      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;
      const address = document.getElementById('address').value;
      const store = document.getElementById('store').value;
      const items = [...document.querySelectorAll('[name="itemName[]"]')].map((el, i) => `${el.value} x${document.querySelectorAll('[name="itemQty[]"]')[i].value}`).join(', ');
      const budget = document.getElementById('budget').value;
      const location = document.getElementById('location').value;
      const date = document.getElementById('deliveryDate').value;
      const time = document.getElementById('deliveryTime').value;

      const message = `*Pasabuy Order*

*Customer:* ${name}
*Phone:* ${phone}
*Address:* ${address}
*Location:* ${location}

*Store:* ${store}
*Items:* ${items}
*Budget:* ${budget}

*Delivery:* ${date} at ${time}
*Downpayment required:* Check summary

*Confirmation No:* #${Math.floor(100000 + Math.random() * 900000)}
`;

      const whatsappURL = `https://wa.me/63XXXXXXXXXX?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, '_blank');
    }

    addItem();
  </script>
</body>
</html>
