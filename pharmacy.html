<!-- Save as pharmacy.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pharmacy - Dalaüö≤Na</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css" rel="stylesheet"/>
  <style>
    .cart-slide {
      transition: transform 0.3s ease-in-out;
      transform: translateX(100%);
    }
    .cart-slide.open {
      transform: translateX(0);
    }
  </style>
</head>
<body class="bg-blue-50 font-sans text-gray-800">
  <!-- Back Arrow -->
  <div class="p-4">
    <a href="select-store.html" class="text-blue-600 text-lg">‚Üê Back to Stores</a>
  </div>

  <!-- Header -->
  <header class="text-center p-4">
    <h1 class="text-3xl font-bold">üè• Dala Na Pharmacy</h1>
    <p class="text-gray-600">Affordable everyday essentials</p>
  </header>

  <!-- Search -->
  <div class="flex justify-center mb-4">
    <input id="search" type="text" placeholder="Search medicines..." class="border p-2 rounded w-2/3">
    <button onclick="searchProducts()" class="ml-2 bg-blue-600 text-white px-4 py-2 rounded">Search</button>
  </div>

  <!-- Product Grid -->
  <section id="product-list" class="grid grid-cols-2 md:grid-cols-4 gap-4 px-4 pb-20"></section>

  <!-- Floating Cart Button -->
  <button onclick="toggleCart()" class="fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-full shadow-md z-50">
    üõí <span id="cart-count">0</span>
  </button>

  <!-- Slide-out Cart -->
  <div id="cart" class="fixed top-0 right-0 w-full sm:w-96 bg-white h-full shadow-lg cart-slide z-40">
    <div class="p-4 border-b flex justify-between items-center">
      <h2 class="text-xl font-bold">üìù Dala-Cart</h2>
      <button onclick="toggleCart()" class="text-red-600 text-xl">‚úï</button>
    </div>
    <div class="p-4 overflow-y-auto h-3/5">
      <ul id="cart-items" class="space-y-2"></ul>
    </div>
    <div class="p-4 border-t text-sm">
      <p>Subtotal: ‚Ç±<span id="subtotal">0.00</span></p>
      <p>VAT (12%): ‚Ç±<span id="vat">0.00</span></p>
      <p>Service Fee: ‚Ç±<span id="service-fee">29.99</span></p>
      <hr class="my-2">
      <p class="font-bold">Total: ‚Ç±<span id="total">0.00</span></p>
      <div class="mt-4">
        <button id="checkout-btn" onclick="openForm()" class="bg-green-600 text-white w-full py-2 rounded" disabled>
          Checkout
        </button>
        <p class="text-xs text-gray-500 mt-2">
          By checking out, you agree to our Terms & Conditions.
        </p>
      </div>
    </div>
  </div>

  <!-- Fillout Modal -->
  <div id="form-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white w-11/12 sm:w-2/3 lg:w-1/2 p-6 rounded shadow-lg">
      <h3 class="text-xl font-bold mb-4">Complete Your Order</h3>
      <iframe id="fillout-frame" src="" class="w-full h-[500px]" frameborder="0"></iframe>
      <div class="text-right mt-4">
        <button onclick="closeForm()" class="text-blue-600">Close</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    const products = [
      { name: "Paracetamol", price: 3, desc: "For fever & pain", img: "https://source.unsplash.com/featured/?pill" },
      { name: "Bioflu", price: 8, desc: "Cold relief", img: "https://source.unsplash.com/featured/?tablet" },
      { name: "Vitamin C 500mg", price: 5, desc: "Immunity booster", img: "https://source.unsplash.com/featured/?vitamin" },
      { name: "Loperamide", price: 6, desc: "Anti-diarrhea", img: "https://source.unsplash.com/featured/?medicine" },
      { name: "Antacid", price: 7, desc: "Stomach relief", img: "https://source.unsplash.com/featured/?antacid" },
      { name: "Hydrite", price: 12, desc: "Oral rehydration", img: "https://source.unsplash.com/featured/?rehydration" },
      { name: "Salbutamol", price: 10, desc: "For asthma", img: "https://source.unsplash.com/featured/?salbutamol" },
      { name: "Multivitamins", price: 6, desc: "Daily supplement", img: "https://source.unsplash.com/featured/?multivitamins" },
      { name: "Alcohol 70%", price: 35, desc: "Disinfectant", img: "https://source.unsplash.com/featured/?alcohol" },
      { name: "Digital Thermometer", price: 150, desc: "For fever check", img: "https://source.unsplash.com/featured/?thermometer" }
    ];

    const cart = {};
    const serviceFee = 29.99;

    function renderProducts() {
      const list = document.getElementById('product-list');
      products.forEach(p => {
        const html = `
          <div class="bg-white shadow-md p-4 rounded-xl">
            <img src="${p.img}" alt="${p.name}" class="rounded mb-2">
            <h3 class="font-bold">${p.name}</h3>
            <p class="text-sm text-gray-600">${p.desc}</p>
            <p class="font-semibold mt-1">‚Ç±${p.price.toFixed(2)}</p>
            <div class="flex mt-2">
              <button onclick="updateQty('${p.name}', ${p.price}, -1)" class="px-2 bg-gray-300 rounded">‚àí</button>
              <span id="qty-${p.name}" class="mx-2">0</span>
              <button onclick="updateQty('${p.name}', ${p.price}, 1)" class="px-2 bg-gray-300 rounded">+</button>
            </div>
          </div>
        `;
        list.insertAdjacentHTML('beforeend', html);
      });
    }

    function updateQty(name, price, change) {
      if (!cart[name]) cart[name] = { qty: 0, price };
      cart[name].qty += change;
      if (cart[name].qty < 0) cart[name].qty = 0;
      document.getElementById(`qty-${name}`).innerText = cart[name].qty;
      updateCartDisplay();
    }

    function updateCartDisplay() {
      const list = document.getElementById("cart-items");
      list.innerHTML = "";
      let subtotal = 0;
      let count = 0;
      for (let item in cart) {
        const { qty, price } = cart[item];
        if (qty === 0) continue;
        count += qty;
        const total = qty * price;
        subtotal += total;
        list.innerHTML += `<li>${item} x${qty} = ‚Ç±${total.toFixed(2)}</li>`;
      }
      const vat = subtotal * 0.12;
      const total = subtotal + vat + serviceFee;
      document.getElementById("cart-count").innerText = count;
      document.getElementById("subtotal").innerText = subtotal.toFixed(2);
      document.getElementById("vat").innerText = vat.toFixed(2);
      document.getElementById("total").innerText = total.toFixed(2);
      document.getElementById("checkout-btn").disabled = count === 0;
    }

    function toggleCart() {
      document.getElementById("cart").classList.toggle("open");
    }

    function openForm() {
      const items = Object.entries(cart).filter(([_, v]) => v.qty > 0);
      const summary = items.map(([k, v]) => `${k} x${v.qty}`).join(', ');
      const url = `https://forms.fillout.com/t/oMZACWUnvFus?cartSummary=${encodeURIComponent(summary)}`;
      document.getElementById("fillout-frame").src = url;
      document.getElementById("form-modal").classList.remove("hidden");
    }

    function closeForm() {
      document.getElementById("form-modal").classList.add("hidden");
      toggleCart();
    }

    function searchProducts() {
      const search = document.getElementById("search").value.toLowerCase();
      const cards = document.querySelectorAll("#product-list > div");
      cards.forEach(card => {
        const text = card.innerText.toLowerCase();
        card.style.display = text.includes(search) ? "" : "none";
      });
    }

    window.onload = renderProducts;
  </script>
</body>
</html>
