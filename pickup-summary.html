<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pickup Summary ‚Äì DalaKoNa</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter&family=Cinzel&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #fff9e6;
      margin: 0;
      padding: 2rem;
      color: #333;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      text-align: center;
    }
    h1 {
      font-family: 'Cinzel', serif;
      color: #008060;
    }
    .summary {
      text-align: left;
      margin-top: 2rem;
    }
    .summary p {
      margin: 0.6rem 0;
    }
    #countdown {
      font-weight: bold;
      color: red;
      font-size: 1.1rem;
    }
    .success {
      display: none;
      color: #008060;
      font-weight: bold;
      font-size: 1.2rem;
      margin-top: 1.5rem;
    }
    .cancel-btn {
      margin-top: 1.5rem;
      padding: 0.6rem 1rem;
      background: crimson;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üßæ Pickup Summary</h1>
    <p>Thank you! Please review the details below. You may cancel within <span id="countdown">2:00</span>.</p>

    <div class="summary">
      <p><strong>From:</strong> <span id="sumFrom"></span></p>
      <p><strong>To:</strong> <span id="sumTo"></span></p>
      <p><strong>Item:</strong> <span id="sumItem"></span></p>
      <p><strong>Payment Method:</strong> <span id="sumPayment"></span></p>
      <p><strong>Estimated Fee:</strong> ‚Ç±<span id="sumFee"></span></p>
      <p><strong>Confirmation Code:</strong> <span id="confirmationCode">-</span></p>
    </div>

    <button class="cancel-btn" id="cancelBtn" onclick="cancelOrder()">‚ùå Cancel Order</button>
    <p class="success" id="successMsg">‚úÖ Confirmed! A rider will be assigned shortly.</p>
  </div>

  <script>
    // Load from query params
    const params = new URLSearchParams(window.location.search);
    const get = (key) => params.get(key) || '-';

    document.getElementById('sumFrom').innerText = get('from');
    document.getElementById('sumTo').innerText = get('to');
    document.getElementById('sumItem').innerText = decodeURIComponent(get('item'));
    document.getElementById('sumPayment').innerText = get('payment');
    document.getElementById('sumFee').innerText = get('fee');

    // Confirmation code generator
    function generateCode() {
      return 'DLK-' + Math.floor(100000 + Math.random() * 900000);
    }

    let seconds = 120;
    const countdownEl = document.getElementById('countdown');
    const cancelBtn = document.getElementById('cancelBtn');
    const successMsg = document.getElementById('successMsg');

    const interval = setInterval(() => {
      if (seconds <= 0) {
        clearInterval(interval);
        cancelBtn.style.display = 'none';
        const code = generateCode();
        document.getElementById('confirmationCode').innerText = code;
        successMsg.style.display = 'block';

        // Trigger WhatsApp send (sample message)
        const msg = `Pickup Confirmed:\nFrom: ${get('from')}\nTo: ${get('to')}\nItem: ${decodeURIComponent(get('item'))}\nPayment: ${get('payment')}\nFee: ‚Ç±${get('fee')}\nCode: ${code}`;
        const phone = '63XXXXXXXXXX'; // Replace with DalaKoNa support
        window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
        return;
      }
      const m = String(Math.floor(seconds / 60)).padStart(1, '0');
      const s = String(seconds % 60).padStart(2, '0');
      countdownEl.innerText = `${m}:${s}`;
      seconds--;
    }, 1000);

    function cancelOrder() {
      clearInterval(interval);
      alert('Your order has been cancelled.');
      window.location.href = 'index.html';
    }
  </script>
</body>
</html>
